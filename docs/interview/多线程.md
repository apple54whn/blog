# 多线程

## 线程 & 进程

**进程**：是**程序**的一次**执行过程**，是系统进行资源分配和处理机调度的基本单位

**线程**：线程是进程中的一个**执行路径**

Java 程序运行原理：Java命令启动JVM（相当于启动了一个进程），由该进程创建启动多个线程，至少两个线程可以分析出来。**执行main()函数的主线程**，**负责垃圾回收的线程**

多线程执行时，其实**每一个执行线程**都有一片自己**所属的栈内存**空间。进行**方法的压栈和弹栈**

## 创建线程的方式

> start本质是先启动线程，再由JVM取调用该线程的run方法（直接调用run方法调用的是普通方法）

- **继承 Thread 并重写run方法**，创建Thread子类对象并调用start方法（多次调用start会抛异常 **IllegalThreadStateException**）

- **实现 Runnable 接口并重写run方法**，**创建Thread对象并将该接口和线程名传入**，调用Thread对象的start方法

  好处是避免单继承的局限性；适合多个相同线程处理同一资源；解耦，代码和线程独立；

- **实现 Callable 接口并重写call方法**，其实现类用 **FutureTask 类来封装**，并**将FutureTask传入Thread的构造**方法中，调用Thread对象start方法。可以**调用FutureTask的get**方法，阻塞等待任务代码执行完毕，获取返回值。

- 利用Executors工厂类来创建线程池。



## sleep() 和 wait() 有什么区别

- sleep是 Thread 的方法，会使调用的线程**休眠**指定时间，且**不会释放锁**，休眠结束回到就绪状态
- wait是 Object 的方法，**等待**并立即**释放锁**，线程被阻塞。**被唤醒后若获得锁那么从这里执行后续代码**。在同步中调用

