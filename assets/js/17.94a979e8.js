(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{144:function(t,v,e){"use strict";e.r(v);var _=e(0),a=Object(_.a)({},function(){var t=this,v=t.$createElement,e=t._self._c||v;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"数据库"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#数据库","aria-hidden":"true"}},[t._v("#")]),t._v(" 数据库")]),t._v(" "),e("h2",{attrs:{id:"jdbc访问数据库的基本步骤"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#jdbc访问数据库的基本步骤","aria-hidden":"true"}},[t._v("#")]),t._v(" JDBC访问数据库的基本步骤")]),t._v(" "),e("ol",[e("li",[e("strong",[t._v("加载驱动")]),t._v("（可省略，static，"),e("code",[t._v("com.mysql.cj.jdbc.Driver")]),t._v("）")]),t._v(" "),e("li",[t._v("（通过DriverManager）"),e("strong",[t._v("获取Connection连接")])]),t._v(" "),e("li",[t._v("（通过连接）"),e("strong",[t._v("获取PrepareStatement对象")]),t._v("（可传入模板）")]),t._v(" "),e("li",[t._v("（通过PrepareStatement）"),e("strong",[t._v("执行SQL语句")])]),t._v(" "),e("li",[e("strong",[t._v("处理结果集")])]),t._v(" "),e("li",[e("strong",[t._v("释放资源")])])]),t._v(" "),e("h2",{attrs:{id:"delete-与-truncate-删除表记录区别"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#delete-与-truncate-删除表记录区别","aria-hidden":"true"}},[t._v("#")]),t._v(" DELETE 与 TRUNCATE 删除表记录区别")]),t._v(" "),e("ul",[e("li",[t._v("DELETE每次从表中删除一行，并将该操作作为事务记录在"),e("strong",[t._v("日志")]),t._v("中以便回滚，"),e("strong",[t._v("不清空 AUTO_INCREMENT 记录")]),t._v("数")]),t._v(" "),e("li",[t._v("TRUNCATE"),e("strong",[t._v("直接删除")]),t._v("表并"),e("strong",[t._v("重新创建")]),t._v("新表，不能回滚， "),e("strong",[t._v("AUTO_INCREMENT置为0")]),t._v("，"),e("strong",[t._v("效率比DELETE高")])])]),t._v(" "),e("h2",{attrs:{id:"事务四大特性（acid）"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#事务四大特性（acid）","aria-hidden":"true"}},[t._v("#")]),t._v(" 事务四大特性（ACID）")]),t._v(" "),e("ul",[e("li",[e("strong",[t._v("原子性")]),t._v("（Atomicity）：事务中所有操作是不可再分割的"),e("strong",[t._v("原子单位")]),t._v("。事务中所有操作要么全部执行成功，要么全部执行失败。")]),t._v(" "),e("li",[e("strong",[t._v("一致性")]),t._v("（Consistency）：在事务开始之前和事务结束以后，数据库"),e("strong",[t._v("状态保持一致")]),t._v("。如转账业务，无论事务执行成功与否，参与转账的两个账号余额之和应该是不变的。")]),t._v(" "),e("li",[e("strong",[t._v("隔离性")]),t._v("（Isolation）：隔离性是指在"),e("strong",[t._v("并发")]),t._v("操作中，"),e("strong",[t._v("不同事务之间应该隔离")]),t._v("开来，使每个并发中的事务不会相互干扰。")]),t._v(" "),e("li",[e("strong",[t._v("持久性")]),t._v("（Durability）：一旦事务"),e("strong",[t._v("提交")]),t._v("成功，它"),e("strong",[t._v("对数据的改变必须是永久")]),t._v("的，即使出现系统故障。")])]),t._v(" "),e("h2",{attrs:{id:"并发事务问题与隔离级别"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#并发事务问题与隔离级别","aria-hidden":"true"}},[t._v("#")]),t._v(" 并发事务问题与隔离级别")]),t._v(" "),e("p",[t._v("问题：")]),t._v(" "),e("ul",[e("li",[t._v("脏读：一个事务读取到另一个事务"),e("strong",[t._v("未提交")]),t._v("的数据")]),t._v(" "),e("li",[t._v("不可重复读：一个事务中"),e("strong",[t._v("两次读取的数据内容")]),t._v("不一致。这是事务中 update 时引发的问题。")]),t._v(" "),e("li",[t._v("幻读：一个事务中"),e("strong",[t._v("两次读取的数据的数量不一致")]),t._v("，这是 insert 或 delete 时引发的问题。")])]),t._v(" "),e("p",[e("strong",[t._v("四大隔离级别")]),t._v("（“×”表示会出现这种问题；“ ”表示不会出现这种问题）")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"center"}},[t._v("级别")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("名称")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("隔离级别")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("脏读")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("不可重复读")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("幻读")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("数据库默认隔离级别")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("读未提交")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("read uncommitted")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("×")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("×")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("×")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("2")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("读已提交")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("read committed")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}}),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("×")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("×")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("Oracle 和 SQL Server")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("3")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("可重复读")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("repeatable read")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}}),t._v(" "),e("td",{staticStyle:{"text-align":"center"}}),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("×")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("MySQL")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("4")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("串行化")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("serializable")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}}),t._v(" "),e("td",{staticStyle:{"text-align":"center"}}),t._v(" "),e("td",{staticStyle:{"text-align":"center"}}),t._v(" "),e("td",{staticStyle:{"text-align":"center"}})])])]),t._v(" "),e("blockquote",[e("p",[t._v("上面的级别最低，下面的级别最高。隔离级别越高，性能越差，安全性越高。")])]),t._v(" "),e("h2",{attrs:{id:"如何进行事务管理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#如何进行事务管理","aria-hidden":"true"}},[t._v("#")]),t._v(" 如何进行事务管理")]),t._v(" "),e("p",[e("strong",[t._v("Connection")]),t._v("的三个方法与事务相关：")]),t._v(" "),e("ul",[e("li",[e("strong",[t._v("setAutoCommit")]),t._v("(boolean)：设置是否为自动提交事务，如果true（默认值就是true）表示自动提交，也就是每条执行的SQL语句都是一个单独的事务，如果设置"),e("strong",[t._v("false")]),t._v("，那么就相当于开启了事务了；")]),t._v(" "),e("li",[e("strong",[t._v("commit")]),t._v("()：提交事务")]),t._v(" "),e("li",[e("strong",[t._v("rollback")]),t._v("()：回滚事务")])]),t._v(" "),e("p",[t._v("还可以设置"),e("strong",[t._v("Savepoint")]),t._v("，允许通过代码设置保存点并让事务回滚到指定的保存点")]),t._v(" "),e("h2",{attrs:{id:"和-区别"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#和-区别","aria-hidden":"true"}},[t._v("#")]),t._v(" #{} 和 ${} 区别")]),t._v(" "),e("ul",[e("li",[t._v("#{} 表示占位符，实现preparedStatement向占位符中赋值的操作，可以防止SQL注入")]),t._v(" "),e("li",[t._v("${} 表示拼接字符串，不能防止SQL注入")])]),t._v(" "),e("h2",{attrs:{id:"mybatis-的一级、二级缓存"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#mybatis-的一级、二级缓存","aria-hidden":"true"}},[t._v("#")]),t._v(" MyBatis 的一级、二级缓存")]),t._v(" "),e("ul",[e("li",[e("p",[t._v("一级缓存是 "),e("strong",[t._v("SqlSession")]),t._v(" 对象的缓存，当调用SqlSession的"),e("strong",[t._v("添加，删除，修改，commit()，close()，clearCache()等")]),t._v("方法时，就会"),e("strong",[t._v("清空一级缓存")]),t._v("。 默认开启。")])]),t._v(" "),e("li",[e("p",[t._v("二级缓存是值"),e("strong",[t._v("SqlSessionFactory")]),t._v("对象的缓存，由同一个SqlSessionFactory对象创建的SqlSession共享")]),t._v(" "),e("p",[e("strong",[t._v("二级缓存存储的只是数据")]),t._v("，当被查询时"),e("strong",[t._v("创建对象并返回")]),t._v("（以至于Hash值不同）")])])]),t._v(" "),e("h2",{attrs:{id:"存储过程"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#存储过程","aria-hidden":"true"}},[t._v("#")]),t._v(" 存储过程")]),t._v(" "),e("p",[t._v("一组为了完成特定功能的 SQL 语句集，经"),e("strong",[t._v("编译")]),t._v("后存储在数据库中，可以通过存储过程名称调用")]),t._v(" "),e("p",[t._v("procedure")]),t._v(" "),e("h2",{attrs:{id:"索引"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#索引","aria-hidden":"true"}},[t._v("#")]),t._v(" 索引")]),t._v(" "),e("p",[t._v("对数据库中一或多个列值的排序，帮助数据库高效获取数据的数据结构。有：普通索引、唯一索引、主键索引、全文索引")]),t._v(" "),e("ul",[e("li",[t._v("优点：\n"),e("ul",[e("li",[e("strong",[t._v("加快检索速度")])]),t._v(" "),e("li",[t._v("唯一索引确保每行数据的唯一性")]),t._v(" "),e("li",[t._v("在使用索引的过程可以优化隐藏器，提高系统性能")])])]),t._v(" "),e("li",[t._v("缺点："),e("strong",[t._v("插入、删除、修改")]),t._v("、维护速度下降，且"),e("strong",[t._v("占")]),t._v("用物理和数据"),e("strong",[t._v("空间")])])]),t._v(" "),e("h2",{attrs:{id:"视图"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#视图","aria-hidden":"true"}},[t._v("#")]),t._v(" 视图")]),t._v(" "),e("p",[t._v("视图就是"),e("strong",[t._v("封装了（复杂）查询的虚拟表")]),t._v("，但是"),e("strong",[t._v("不包含数据，只包含查询SQL")]),t._v("；")]),t._v(" "),e("p",[t._v("封装，隐藏细节，保护数据；视图不能被索引。")]),t._v(" "),e("div",{staticClass:"language-mysql extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("-- 创建视图\nCREATE VIEW myview\nAS\nSELECT ...\n-- 修改视图\nCREATE OR REPLACE VIEW myview\nAS\nSELECT ...\n-- 也可以这样修改\nALTER VIEW myview \nAS\nSELECT ...\n-- 删除视图\nDROP VIEW myview,myview1...\n")])])]),e("h2",{attrs:{id:"sql-优化"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#sql-优化","aria-hidden":"true"}},[t._v("#")]),t._v(" SQL 优化")]),t._v(" "),e("ul",[e("li",[e("p",[t._v("查询结果"),e("strong",[t._v("不要用")]),e("code",[t._v("*")]),t._v("来查询所有字段，要明确"),e("strong",[t._v("指明结果字段")])])]),t._v(" "),e("li",[e("p",[t._v("对查询进行优化，避免全表扫描，首先应考虑在 "),e("strong",[t._v("where 及 order by 涉及的列上建立索引")])])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("索引不是越多越好")]),t._v("。提高select效率同时，降低了"),e("strong",[t._v("insert和update")]),t._v("效率（可能会重建索引）。一个表索引数最好不要超过6个")]),t._v(" "),e("p",[t._v("根据查询条件，建立索引，如果"),e("strong",[t._v("查询条件不止一个")]),t._v("时，使用"),e("strong",[t._v("组合索引")])]),t._v(" "),e("p",[e("strong",[t._v("避免在 where 子句中对字段进行 null 值判断、使用!=或<>操作符、使用 or 来连接条件、in 和 not in 也要慎用")]),t._v("，否则将导致引擎放弃使用索引而进行全表扫描")]),t._v(" "),e("p",[t._v("在查询"),e("strong",[t._v("条件表达式的左侧尽量不要使用函数")]),t._v("，否则索引失效")]),t._v(" "),e("p",[t._v("如果有 "),e("strong",[t._v("like")]),t._v(" 话，"),e("strong",[t._v("最右%可以使用索引")])])]),t._v(" "),e("li",[e("p",[t._v("大数据量中分页限制")])])]),t._v(" "),e("h2",{attrs:{id:"mysql-数据库优化"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#mysql-数据库优化","aria-hidden":"true"}},[t._v("#")]),t._v(" MySQL 数据库优化")]),t._v(" "),e("ul",[e("li",[e("strong",[t._v("EXPLAIN")]),t._v(" 你的 SELECT 查询")]),t._v(" "),e("li",[t._v("当只要"),e("strong",[t._v("一行数据")]),t._v("时使用 "),e("strong",[t._v("LIMIT 1")])]),t._v(" "),e("li",[t._v("使用 "),e("strong",[t._v("ENUM")]),t._v(" 而"),e("strong",[t._v("不是 VARCHAR")])]),t._v(" "),e("li",[e("strong",[t._v("固定长度的表")]),t._v("会更"),e("strong",[t._v("快")])])]),t._v(" "),e("h2",{attrs:{id:"常用工具"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#常用工具","aria-hidden":"true"}},[t._v("#")]),t._v(" 常用工具")]),t._v(" "),e("h3",{attrs:{id:"慢查询日志-mysqldumpslow"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#慢查询日志-mysqldumpslow","aria-hidden":"true"}},[t._v("#")]),t._v(" 慢查询日志-Mysqldumpslow")]),t._v(" "),e("h3",{attrs:{id:"explain-执行计划"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#explain-执行计划","aria-hidden":"true"}},[t._v("#")]),t._v(" Explain 执行计划")]),t._v(" "),e("ul",[e("li",[t._v("有众多指标\n"),e("ul",[e("li",[t._v("type")]),t._v(" "),e("li",[t._v("ref")])])])]),t._v(" "),e("h3",{attrs:{id:"query-profiling-查询性能瓶颈"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#query-profiling-查询性能瓶颈","aria-hidden":"true"}},[t._v("#")]),t._v(" Query Profiling 查询性能瓶颈")]),t._v(" "),e("h3",{attrs:{id:"查询sql执行时间"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#查询sql执行时间","aria-hidden":"true"}},[t._v("#")]),t._v(" 查询SQL执行时间")]),t._v(" "),e("h3",{attrs:{id:"数据库连接进程表"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#数据库连接进程表","aria-hidden":"true"}},[t._v("#")]),t._v(" 数据库连接进程表")]),t._v(" "),e("p",[t._v("show processlist;")]),t._v(" "),e("h2",{attrs:{id:"引擎"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#引擎","aria-hidden":"true"}},[t._v("#")]),t._v(" 引擎")]),t._v(" "),e("h3",{attrs:{id:"innodb"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#innodb","aria-hidden":"true"}},[t._v("#")]),t._v(" InnoDB")]),t._v(" "),e("ul",[e("li",[t._v("支持"),e("strong",[t._v("事务")])]),t._v(" "),e("li",[t._v("有"),e("strong",[t._v("行级锁")]),t._v("，只在where主键时有用")]),t._v(" "),e("li",[t._v("有"),e("strong",[t._v("外键约束")])]),t._v(" "),e("li",[t._v("有"),e("strong",[t._v("容灾性")]),t._v("（通过bin-log恢复）")]),t._v(" "),e("li",[t._v("用于经常更新的表")])]),t._v(" "),e("h3",{attrs:{id:"myisam"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#myisam","aria-hidden":"true"}},[t._v("#")]),t._v(" MyIsam")]),t._v(" "),e("ul",[e("li",[t._v("上述三条都不支持")]),t._v(" "),e("li",[t._v("没有容灾性，不能恢复，需经常备份")]),t._v(" "),e("li",[e("strong",[t._v("保存了行数")]),t._v("，做"),e("strong",[t._v("count计算")]),t._v("，如日志、调查等，不需要像InnoDB需查询全表")]),t._v(" "),e("li",[t._v("支持"),e("strong",[t._v("组合索引")]),t._v("，而InnoDB不支持")]),t._v(" "),e("li",[e("strong",[t._v("读取操作很快")]),t._v("，用于读取操作远多于写操作且不需要事务支持的表")]),t._v(" "),e("li")]),t._v(" "),e("h2",{attrs:{id:"主从复制master-slave"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#主从复制master-slave","aria-hidden":"true"}},[t._v("#")]),t._v(" 主从复制Master/Slave")]),t._v(" "),e("ul",[e("li",[t._v("数据同步备份")]),t._v(" "),e("li",[e("strong",[t._v("读写分离")]),t._v("：把写操作放入Master；读操作放入Slave，减轻单一数据库压力")]),t._v(" "),e("li",[t._v("分布式部署，高可用")])]),t._v(" "),e("p",[t._v("master库的更新事件，被写入bin-log，master的binlog线程把bin-log发送到slave，从库启动后先写入relaylog将更新内容写入DB")])])},[],!1,null,null,null);v.default=a.exports}}]);